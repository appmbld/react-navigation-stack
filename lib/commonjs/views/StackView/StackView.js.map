{"version":3,"sources":["StackView.tsx"],"names":["USE_NATIVE_DRIVER","DefaultNavigationConfig","mode","cardShadowEnabled","cardOverlayEnabled","StackView","configureTransition","transitionProps","prevTransitionProps","useNativeDriver","TransitionConfigs","getTransitionConfig","props","navigationConfig","transitionConfig","transitionSpec","getShadowEnabled","hasOwnProperty","getCardOverlayEnabled","renderStackviewLayout","lastTransitionProps","screenProps","onGestureBegin","onGestureCanceled","getPauseGesture","onGestureEnd","handleTransitionEnd","transition","lastTransition","navigation","onTransitionEnd","transitionDestKey","scene","route","key","isCurrentKey","state","routes","index","isTransitioning","dispatch","StackActions","completeTransition","toChildKey","descriptors","onTransitionStart","onPauseGesture","undefined","React","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { StackActions } from '@react-navigation/core';\nimport StackViewLayout from './StackViewLayout';\nimport Transitioner from '../Transitioner';\nimport TransitionConfigs from './StackViewTransitionConfigs';\nimport {\n  NavigationProp,\n  SceneDescriptor,\n  NavigationConfig,\n  TransitionProps,\n  Scene,\n  GesturePauseConfig,\n} from '../../types';\n\ntype Props = {\n  navigation: NavigationProp;\n  descriptors: { [key: string]: SceneDescriptor };\n  navigationConfig: NavigationConfig;\n  onTransitionStart?: () => void;\n  onGestureBegin?: () => void;\n  onPauseGesture?: (config: GesturePauseConfig) => void;\n  onGestureCanceled?: () => void;\n  onGestureEnd?: () => void;\n  screenProps?: unknown;\n};\n\nconst USE_NATIVE_DRIVER = true;\n\n// NOTE(brentvatne): this was previously in defaultProps, but that is deceiving\n// because the entire object will be clobbered by navigationConfig that is\n// passed in.\nconst DefaultNavigationConfig = {\n  mode: 'card',\n  cardShadowEnabled: true,\n  cardOverlayEnabled: false,\n};\n\nclass StackView extends React.Component<Props> {\n  render() {\n    return (\n      <Transitioner\n        render={this.renderStackviewLayout}\n        configureTransition={this.configureTransition}\n        screenProps={this.props.screenProps}\n        navigation={this.props.navigation}\n        descriptors={this.props.descriptors}\n        onTransitionStart={\n          this.props.onTransitionStart ||\n          this.props.navigationConfig.onTransitionStart\n        }\n        onTransitionEnd={this.handleTransitionEnd}\n      />\n    );\n  }\n\n  componentDidMount() {\n    const { navigation } = this.props;\n    if (navigation.state.isTransitioning) {\n      navigation.dispatch(\n        StackActions.completeTransition({\n          key: navigation.state.key,\n        })\n      );\n    }\n  }\n\n  private configureTransition = (\n    transitionProps: TransitionProps,\n    prevTransitionProps?: TransitionProps\n  ) => {\n    return {\n      useNativeDriver: USE_NATIVE_DRIVER,\n      ...TransitionConfigs.getTransitionConfig(\n        this.props.navigationConfig.transitionConfig,\n        transitionProps,\n        prevTransitionProps,\n        this.props.navigationConfig.mode === 'modal'\n      ).transitionSpec,\n    };\n  };\n\n  private getShadowEnabled = () => {\n    const { navigationConfig } = this.props;\n    return navigationConfig &&\n      navigationConfig.hasOwnProperty('cardShadowEnabled')\n      ? navigationConfig.cardShadowEnabled\n      : DefaultNavigationConfig.cardShadowEnabled;\n  };\n\n  private getCardOverlayEnabled = () => {\n    const { navigationConfig } = this.props;\n    return navigationConfig &&\n      navigationConfig.hasOwnProperty('cardOverlayEnabled')\n      ? navigationConfig.cardOverlayEnabled\n      : DefaultNavigationConfig.cardOverlayEnabled;\n  };\n\n  private getPauseGesture() {\n    const { navigationConfig } = this.props;\n    return navigationConfig && navigationConfig.hasOwnProperty('onPauseGesture')\n      ? navigationConfig.onPauseGesture\n      : undefined;\n  }\n\n  private renderStackviewLayout = (\n    transitionProps: TransitionProps,\n    lastTransitionProps?: TransitionProps\n  ) => {\n    const { screenProps, navigationConfig } = this.props;\n    return (\n      <StackViewLayout\n        {...navigationConfig}\n        shadowEnabled={this.getShadowEnabled()}\n        cardOverlayEnabled={this.getCardOverlayEnabled()}\n        onGestureBegin={this.props.onGestureBegin}\n        onGestureCanceled={this.props.onGestureCanceled}\n        onPauseGesture={this.getPauseGesture()}\n        onGestureEnd={this.props.onGestureEnd}\n        screenProps={screenProps}\n        transitionProps={transitionProps}\n        lastTransitionProps={lastTransitionProps}\n      />\n    );\n  };\n\n  private handleTransitionEnd = (\n    transition: { scene: Scene; navigation: NavigationProp },\n    lastTransition?: { scene: Scene; navigation: NavigationProp }\n  ) => {\n    const {\n      navigationConfig,\n      navigation,\n      // @ts-ignore\n      onTransitionEnd = navigationConfig.onTransitionEnd,\n    } = this.props;\n    const transitionDestKey = transition.scene.route.key;\n    const isCurrentKey =\n      navigation.state.routes[navigation.state.index].key === transitionDestKey;\n    if (transition.navigation.state.isTransitioning && isCurrentKey) {\n      navigation.dispatch(\n        StackActions.completeTransition({\n          key: navigation.state.key,\n          toChildKey: transitionDestKey,\n        })\n      );\n    }\n    onTransitionEnd && onTransitionEnd(transition, lastTransition);\n  };\n}\n\nexport default StackView;\n"]}